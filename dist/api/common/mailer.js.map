{"version":3,"sources":["../../../api/common/mailer.js"],"names":["P","config","sendgrid","require","sendgridkey","sendAffiliateEmail","first_name","last_name","phone","skype","cell","background","email","Email","to","from","fromname","subject","html","text","setFilters","addSubstitution","resolve","reject","send","err","json"],"mappings":"AAAA,OAAOA,CAAP,MAAc,UAAd;AACA,OAAOC,MAAP,MAAmB,SAAnB;AACA,MAAMC,WAAWC,QAAQ,UAAR,EAAoBF,OAAOG,WAA3B,CAAjB;;AAEA,OAAO,eAAeC,kBAAf,CAAkC,EAACC,UAAD,EAAaC,SAAb,EAAwBC,KAAxB,EAA+BC,KAA/B,EAAsCC,IAAtC,EAA4CC,UAA5C,EAAlC,EAA2F;AAChG,MAAIC,QAAQ,IAAIV,SAASW,KAAb,CAAmB;AAC7BC,QAAIF,KADyB;AAE7BG,UAAM,6BAFuB;AAG7BC,cAAU,iBAHmB;AAI7BC,aAAS,iBAJoB;AAK7BC,UAAM,2BALuB,EAKM;AACnCC,UAAM,kBANuB,CAMJ;AANI,GAAnB,CAAZ;;AASF;AACEP,QAAMQ,UAAN,CAAiB,EAAC,aAAa,EAAC,YAAY,EAAC,WAAW,CAAZ,EAAe,eAAe,sCAA9B,EAAb,EAAd,EAAjB;AACAR,QAAMS,eAAN,CAAsB,cAAtB,EAAsCf,UAAtC;AACAM,QAAMS,eAAN,CAAsB,aAAtB,EAAqCd,SAArC;AACAK,QAAMS,eAAN,CAAsB,SAAtB,EAAiCb,KAAjC;AACAI,QAAMS,eAAN,CAAsB,SAAtB,EAAiCZ,KAAjC;AACAG,QAAMS,eAAN,CAAsB,QAAtB,EAAgCX,IAAhC;AACAE,QAAMS,eAAN,CAAsB,cAAtB,EAAsCV,UAAtC;;AAEA,SAAO,IAAIX,CAAJ,CAAM,UAASsB,OAAT,EAAkBC,MAAlB,EAAyB;AACpCrB,aAASsB,IAAT,CAAcZ,KAAd,EAAqB,UAASa,GAAT,EAAcC,IAAd,EAAmB;AACtC,UAAID,GAAJ,EAAS;AACPF,eAAOE,GAAP;AACD,OAFD,MAEO;AACLH,gBAAQI,IAAR;AACD;AACF,KAND;AAOD,GARM,CAAP;AASD","file":"mailer.js","sourcesContent":["import P from 'bluebird';\nimport config from 'config3';\nconst sendgrid = require('sendgrid')(config.sendgridkey);\n\nexport async function sendAffiliateEmail({first_name, last_name, phone, skype, cell, background}) {\n  var email = new sendgrid.Email({\n    to: email,\n    from: \"autobot@tacticalmastery.com\",\n    fromname: \"TacticalMastery\",\n    subject: \"Affiliate Email\",\n    html: '<h2>Affiliate Email!</h2>', // <%body%> tag for text\n    text: 'Affiliate Email!' // <%body%> tag for html\n  });\n\n// add filter settings one at a time\n  email.setFilters({\"templates\": {\"settings\": {\"enabled\": 1, \"template_id\": \"d88a7a32-0f16-44fc-8020-de6c6f3b65d0\"}}});\n  email.addSubstitution('-first_name-', first_name);\n  email.addSubstitution('-last_name-', last_name);\n  email.addSubstitution('-phone-', phone);\n  email.addSubstitution('-skype-', skype);\n  email.addSubstitution('-cell-', cell);\n  email.addSubstitution('-background-', background);\n\n  return new P(function(resolve, reject){\n    sendgrid.send(email, function(err, json){\n      if (err) {\n        reject(err);\n      } else {\n        resolve(json);\n      }\n    });\n  });\n}\n"]}